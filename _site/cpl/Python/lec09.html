<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/assets/css/style.css?v=cfb48777155d75d39491f68b9e62d23459526d4b">
    <link rel="stylesheet" type="text/css" href="/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

<!-- Begin Jekyll SEO tag v2.3.0 -->
<title>CPL: Decorators to Decorators | healym.github.io</title>
<meta property="og:title" content="CPL: Decorators to Decorators" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Notes for Contemporary Programming Languages" />
<meta property="og:description" content="Notes for Contemporary Programming Languages" />
<meta property="og:site_name" content="healym.github.io" />
<script type="application/ld+json">
{"name":null,"description":"Notes for Contemporary Programming Languages","author":null,"@type":"WebPage","url":"/cpl/Python/lec09.html","publisher":null,"image":null,"headline":"CPL: Decorators to Decorators","dateModified":null,"datePublished":null,"sameAs":null,"mainEntityOfPage":null,"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  </head>

  <body>
    <div id="container">
      <div class="inner">

        <header>
          <h1>CPL: Decorators to Decorators</h1>
          <h2>Notes for Contemporary Programming Languages</h2>
        </header>
        <section id="downloads" class="clearfix">
          
	  
          <a href="http://github.com/healym/healym.github.io" id="view-on-github" class="button"><span>View on GitHub</span></a>
	  
        </section>
        <hr>
        <section id="main_content">
          <h1 id="cpl-decorators-to-decorators">CPL: Decorators to Decorators</h1>

<h2 id="a-study-of-higher-order-functions">A study of higher order functions</h2>

<h2 id="abdirahman-ahmed-osman">Abdirahman Ahmed Osman</h2>

<h2 id="pre-class">Pre-class</h2>

<p>Consider theto_bin()andcount_forever()generator functions from class -
to_bin(it)returns an iterable that converts every item from <em>it</em> to its binary rep-
resentation -count_forever(start = 0)return an iterable that yieldsstart,
start + 1,start + 2…</p>

<p>For each snippet, indicate whether it terminates or not</p>

<div class="highlighter-rouge"><pre class="highlight"><code>to_bin(count_forever())
(bin(x) for x in count_forever())
{x: bin(x) for x in count_forever()}
</code></pre>
</div>
<p>Define a function <em>count</em> and a variable <em>init</em> so thatreduce(count,my_list,
init) would return a dictionary indicating the number of times each item occurs
inmy_list.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>from functools import reduce
# count definition
# init assignment
my_list = ['they','were', 'the', ....,'times']
reduce(count_my_list, init)
# {"best":1,"worst":1,"they":2...}
</code></pre>
</div>
<h2 id="decorators-and-such">Decorators and such</h2>

<p><strong>def</strong> time_this(func):
<strong>def</strong> wrapper(*args, <strong>kwargs):
start = time.time()
retval = func(*args, **kwargs)
stop = time.time()
print(“{} took {:0.3f}sec”.format(func.__name__, stop-start))
**return</strong> retval
<strong>return</strong> wrapper</p>

<p>@time_this
<strong>def</strong> add5(x):
time.sleep(1.0)
<strong>return</strong> x + 5</p>

<p>add5(10) _# return 15</p>
<h1 id="print">print:</h1>
<h1 id="add5-took-1001-sec_">add5 took 1.001 sec_</h1>

<p>deff add10(x):
time.sleep(2.0)
<strong>return</strong> x + 10</p>

<p>add10 = time_this(add10) <em># same as putting @time_this before the function definition</em></p>

<h3 id="fun-facts">Fun facts</h3>

<ul>
  <li>The@syntax is syntactic sugar forfunc = dec(func)</li>
  <li>You can stack multiple decorators!
  @
  @
  <strong>def</strong> func():
     <strong>pass</strong></li>
  <li>You can decorate decorators</li>
  <li>A decorator will <strong>clobber</strong> a wrapper function’s docstrings,<strong>name</strong>, and
  other special attributes.
     <strong>-</strong> Usefunctools.wrapsto avoid this
        ∗it moves special attributes from function to the new wrapped
           function</li>
</ul>

<h3 id="validation">Validation</h3>

<p>@validate_int
<strong>def</strong> prompt_for_age():
<strong>return</strong> input(“Enter your age:”)</p>

<p>prompt_for_age()
_# Enter your age: bob</p>
<h1 id="requires-int">Requires int!</h1>
<h1 id="enter-your-age-1_">Enter your age: 1_</h1>

<p>Now let’s buildvallidate_int(func)</p>

<p>import functools</p>

<p><strong>def</strong> validate_int(func):
@functools.wraps(func)
<strong>def</strong> wrapper(<em>args,<strong>kwargs):
**while</strong> True:
<strong>try</strong> :
integer_value == int(func(</em>args,<strong>kwargs))
**return</strong> integer_value
<strong>except</strong> ValueError:
print(‘Requires int!”)
return wrapper</p>

<p><strong>Let’s make it more general</strong></p>

<p><strong>def</strong> validate(const=int):
<strong>def</strong> decorator(func):
<strong>def</strong> wrapper(<em>args,<strong>kwargs):
**while</strong> True:
<strong>try</strong> :
<strong>return</strong> const(func(</em>args, <strong>kwargs))
**except</strong> ValueError:
print(“Invalid value”)
<strong>return</strong> wrapper
<strong>return</strong> decorator</p>

<p>@validate(float)
<strong>def</strong> prompt_for_age():
<strong>return</strong> input(“Enter your age: “)</p>

<p><em># same as</em>
prompt_for_age = validate(float)(prompt_for_age)</p>

<h2 id="packages">Packages</h2>

<ul>
  <li>Structure a python’s module namespace using “dotted module names”
  main.py
  classroom/
  <strong>init</strong>.py</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>utilities.py
modles/
__init__.py
assignment.py
</code></pre>
</div>
<ul>
  <li>Inmain.py</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>import classroom.utilities
import classroom.modles.assignment
from classroom.models.assignment import Assignment
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code>classroom.utilites.grade()
a = Assignment()
</code></pre>
</div>

        </section>

        <footer>
        
          healym.github.io is maintained by <a href="http://github.com/healym">healym</a><br>
        
          This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

      </div>
    </div>

    
  </body>
</html>
